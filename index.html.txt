<!DOCTYPE html>
<html lang="ja" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ­´å²ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒ™ãƒ«â˜…6å¹´ç¤¾ä¼š</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700&display=swap');
    body { font-family: 'Zen Maru Gothic', sans-serif; background: #f0f9ff; }
    .chat-message { animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
    @keyframes popIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
    .custom-scroll::-webkit-scrollbar { width: 6px; }
    .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    .glass-card { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(10px); }
    .era-section { border-left: 4px solid #f97316; padding-left: 12px; margin-bottom: 12px; }
  </style>
</head>
<body class="h-full">
  <div id="app" class="min-h-full py-6 px-4" style="background: linear-gradient(135deg, #e0f2fe 0%, #fef3c7 100%);">
    <div class="max-w-4xl mx-auto">
      
      <header class="text-center mb-6">
        <h1 class="text-4xl font-extrabold mb-2 text-orange-500 drop-shadow-sm">ğŸ•°ï¸ æ­´å²ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒ™ãƒ«â˜…</h1>
        <p class="text-blue-600 font-bold text-lg">æ˜”ã®æ—¥æœ¬ã¸ã‚´ãƒ¼ï¼æ­´å²ã®ãƒ—ãƒ­ã«èã„ã¦ã¿ã‚ˆã†ï¼</p>
      </header>

      <div class="glass-card rounded-3xl shadow-xl overflow-hidden min-h-[750px] flex flex-col border-4 border-white">
        
        <div id="home-view" class="p-6 space-y-8 overflow-y-auto custom-scroll flex-1">
          <section>
            <h2 class="text-xl font-bold text-orange-500 mb-4 flex items-center gap-2">
              <span class="text-2xl">â³</span> æ™‚ä»£ã‚’é¸ã‚“ã§ã€Œãã‚‰ã—ã€ã‚’èã
            </h2>
            <div id="era-list" class="flex flex-wrap gap-2"></div>
          </section>

          <section>
            <h2 class="text-xl font-bold text-blue-500 mb-6 flex items-center gap-2 border-b-2 border-blue-100 pb-2">
              <span class="text-2xl">ğŸ‘¥</span> æ­´å²ã®äººç‰©ã«ä¼šã†ï¼ˆæ™‚ä»£é †ï¼‰
            </h2>
            <div id="person-sections" class="space-y-8"></div>
          </section>
        </div>

        <div id="chat-view" class="hidden flex-1 flex flex-col h-full bg-white/50">
          <div class="p-4 bg-white/90 border-b flex justify-between items-center shadow-sm">
            <div class="flex items-center gap-3">
              <div id="target-icon" class="text-4xl bg-orange-100 p-2 rounded-full"></div>
              <div>
                <h2 id="target-name" class="font-bold text-2xl text-slate-800"></h2>
                <span class="text-xs bg-blue-100 text-blue-600 px-2 py-0.5 rounded-full font-bold">æ­´å²ã®äº‹å®Ÿã‚’ç­”ãˆã‚‹ã‚ˆ</span>
              </div>
            </div>
            <button onclick="goToHome()" class="font-bold text-white bg-orange-400 px-6 py-2 rounded-full hover:bg-orange-500 shadow-md">ãƒ›ãƒ¼ãƒ ã¸æˆ»ã‚‹</button>
          </div>
          
          <div id="chat-history" class="flex-1 overflow-y-auto p-6 space-y-4 custom-scroll"></div>
          
          <form id="chat-form" class="p-4 bg-white border-t flex gap-3">
            <input id="chat-input" type="text" class="flex-1 border-2 border-blue-100 rounded-2xl px-5 py-3 outline-none focus:border-orange-400 transition text-lg font-bold" placeholder="çŸ¥ã‚ŠãŸã„ã“ã¨ã‚’èã„ã¦ã­ï¼" required>
            <button type="submit" class="bg-blue-500 text-white px-8 py-3 rounded-2xl font-bold hover:bg-blue-600 shadow-lg">èãï¼</button>
          </form>
        </div>

      </div>
    </div>
  </div>

  <script>
    // â˜…APIã‚­ãƒ¼ã‚’æœ€æ–°ã®ã‚‚ã®ã«æ›´æ–°ã—ã¾ã—ãŸ
    const API_KEY = "AIzaSyA8Ud9x1Fls-bjRaxcCWaZqNn96azH_yPU";
    
    const eraData = [
      { name: "å¼¥ç”Ÿãƒ»å¤å¢³", people: ["å‘å¼¥å‘¼"] },
      { name: "é£›é³¥ãƒ»å¥ˆè‰¯", people: ["è–å¾³å¤ªå­", "å°é‡å¦¹å­", "ä¸­å¤§å…„çš‡å­", "ä¸­è‡£éŒè¶³", "è–æ­¦å¤©çš‡", "è¡ŒåŸº", "é‘‘çœŸ"] },
      { name: "å¹³å®‰", people: ["è—¤åŸé“é•·", "ç´«å¼éƒ¨", "æ¸…å°‘ç´è¨€", "å¹³æ¸…ç››"] },
      { name: "éŒå€‰ãƒ»å—åŒ—æœ", people: ["æºé ¼æœ", "æºç¾©çµŒ", "åŒ—æ¡æ™‚å®—", "è¶³åˆ©å°Šæ°"] },
      { name: "å®¤ç”ºãƒ»æˆ¦å›½", people: ["è¶³åˆ©ç¾©æº€", "è¶³åˆ©ç¾©æ”¿", "é›ªèˆŸ", "ã‚¶ãƒ“ã‚¨ãƒ«", "ç¹”ç”°ä¿¡é•·", "è±Šè‡£ç§€å‰"] },
      { name: "æ±Ÿæˆ¸", people: ["å¾³å·å®¶åº·", "å¾³å·å®¶å…‰", "è¿‘æ¾é–€å·¦è¡›é–€", "æ­Œå·åºƒé‡", "æœ¬å±…å®£é•·", "æ‰ç”°ç„ç™½", "ä¼Šèƒ½å¿ æ•¬", "ãƒšãƒªãƒ¼"] },
      { name: "æ˜æ²»", people: ["å‚æœ¬é¾é¦¬", "è¥¿éƒ·éš†ç››", "å¤§ä¹…ä¿åˆ©é€š", "æœ¨æˆ¸å­å…", "ç¦æ²¢è«­å‰", "ä¼Šè—¤åšæ–‡", "é™¸å¥¥å®—å…‰", "å°æ‘å¯¿å¤ªéƒ", "ä¸è¬é‡æ™¶å­", "é‡å£è‹±ä¸–", "å¹³å¡šã‚‰ã„ã¦ã†", "æ¸‹æ²¢æ „ä¸€"] }
    ];

    const eras = ["ç¸„æ–‡æ™‚ä»£","å¼¥ç”Ÿæ™‚ä»£","å¤å¢³æ™‚ä»£","é£›é³¥æ™‚ä»£","å¥ˆè‰¯æ™‚ä»£","å¹³å®‰æ™‚ä»£","éŒå€‰æ™‚ä»£","å®¤ç”ºæ™‚ä»£","å®‰åœŸæ¡ƒå±±æ™‚ä»£","æ±Ÿæˆ¸æ™‚ä»£","æ˜æ²»æ™‚ä»£","å¤§æ­£æ™‚ä»£","æ˜­å’Œæ™‚ä»£"];

    let currentSelection = "";

    function init() {
      document.getElementById('era-list').innerHTML = eras.map(e => `
        <button onclick="startChat('${e}', 'ğŸ•°ï¸')" class="px-5 py-2 bg-white text-orange-500 rounded-full text-sm font-bold shadow-sm border-2 border-orange-100 hover:bg-orange-50 transition">${e}</button>`).join('');

      const container = document.getElementById('person-sections');
      container.innerHTML = eraData.map(data => `
        <div class="era-section">
          <h3 class="text-sm font-bold text-slate-500 mb-3">${data.name}</h3>
          <div class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-5 gap-3">
            ${data.people.map(p => `
              <button onclick="startChat('${p}', 'ğŸ‘¤')" class="p-3 bg-white border-2 border-blue-50 rounded-xl hover:border-blue-200 shadow-sm transition text-center font-bold text-slate-700 text-sm">${p}</button>
            `).join('')}
          </div>
        </div>
      `).join('');
    }

    function startChat(name, icon) {
      currentSelection = name;
      document.getElementById('home-view').classList.add('hidden');
      document.getElementById('chat-view').classList.remove('hidden');
      document.getElementById('target-name').textContent = name;
      document.getElementById('target-icon').textContent = icon;
      document.getElementById('chat-history').innerHTML = '';
      addMessage('ai', `ã‚„ã‚ã€ç§ã¯ã€Œ${name}ã€ã ã‚ˆã€‚æ­´å²ã®è¨˜éŒ²ã‚’ã‚‚ã¨ã«ã€æ­£ã—ã„äº‹å®Ÿã‚’æ•™ãˆã‚‹ã­ã€‚ä½•ã§ã‚‚èã„ã¦ã‚ˆï¼`);
    }

    function goToHome() {
      document.getElementById('home-view').classList.remove('hidden');
      document.getElementById('chat-view').classList.add('hidden');
    }

    async function getAIResponse(userQuery) {
      const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`;
      try {
        const response = await fetch(url, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            contents: [{
              parts: [{
                text: `ã‚ãªãŸã¯ã€Œ${currentSelection}ã€ã¨ã—ã¦æŒ¯ã‚‹èˆã„ã€å°å­¦ç”Ÿã«ã‚‚ã‚ã‹ã‚Šã‚„ã™ãç­”ãˆã¦ãã ã•ã„ã€‚æ­´å²çš„äº‹å®Ÿã«åŸºã¥ãã€è¦ªã—ã¿ã‚„ã™ã„å£èª¿ã§è©±ã—ã¦ãã ã•ã„ã€‚è³ªå•ï¼š${userQuery}`
              }]
            }]
          })
        });

        const data = await response.json();
        if (data.error) {
          return "ã€ã‚¨ãƒ©ãƒ¼ã€‘" + data.error.message;
        }
        return data.candidates[0].content.parts[0].text;
      } catch (err) {
        return "é€šä¿¡ã‚¨ãƒ©ãƒ¼ã ã‚ˆã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆãŒã¤ãªãŒã£ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ã­ã€‚";
      }
    }

    document.getElementById('chat-form').onsubmit = async (e) => {
      e.preventDefault();
      const input = document.getElementById('chat-input');
      const q = input.value.trim();
      if (!q) return;

      addMessage('user', q);
      input.value = '';

      const loadingId = addMessage('ai', 'æ­´å²ã®è³‡æ–™ã‚’èª¿ã¹ã¦ã„ã‚‹ã‚ˆ...');
      const answer = await getAIResponse(q);
      document.getElementById(loadingId).innerText = answer;
    };

    function addMessage(type, text) {
      const h = document.getElementById('chat-history');
      const id = 'm-' + Date.now() + Math.random();
      const div = document.createElement('div');
      div.className = `chat-message flex ${type === 'user' ? 'justify-end' : 'justify-start'}`;
      
      const bgColor = type === 'user' ? 'bg-blue-500 text-white rounded-tr-none' : 'bg-white text-slate-700 rounded-tl-none border-2 border-blue-50';
      
      div.innerHTML = `<div id="${id}" class="max-w-[85%] p-4 rounded-2xl text-base font-bold shadow-sm ${bgColor} whitespace-pre-wrap leading-relaxed">${text}</div>`;
      
      h.appendChild(div);
      h.scrollTop = h.scrollHeight;
      return id;
    }

    init();
  </script>
</body>
</html>
